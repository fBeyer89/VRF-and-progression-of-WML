# VRF-and-progression-of-WML
This repository contains analysis and simulation scripts for the pre-registered project on the association of vascular risk factors and progression of white matter hyperintensities.

To rerun the analysis with a surrogate dataset, please use `calc_models_on_synthdata.R`:


## synthetic_imputed_data
`synthetic_imputed_data.Rdata` synthetic dataset created by `data_analysis/prepare_data/

## data_analysis
- `calc_models_on_realdata.R`: function to run all analyses on imputed data and write result csv files and figures
- `calc_models_on_synthdata.R`: function to run all analyses on synthetic imputed data and write result csv files and figures (to be used for reproducing results & manuscript)

- functions used in `calc_models_on_realdata.R`:
    - `run_conf_LME.R`: run confirmatory analyses for H1 - H3
    - `run_conf_LME_sex_stratified.R`: run exploratory analyses for E1a-E3b
    - `run_exp_LME.R`: run exploratory analyses for E1a-E3b
    - `test_LME_assumptions.R`: test assumptions of models except for VIF
 
### manuscript
- `manuscript_RR_CVR_cSVD.Rmd` to create the manuscript from results generated by `calc_models_on_*data.R`
- `supplements.Rmd` to create the supplementary information from results generated by `calc_models_on_*data.R`

- `Stage2_manuscript_RR_CVR_cSVD_Final.docx`: final text + reordered tables/figures
- `Stage2_manuscript_RR_CVR_cSVD_Final_trackchanges.docx`: reordered tables/figures and track all changes compared to stage 1 manuscript
- `supplements_Final.docx`: final supplement file

additional functions/files:
`create_flowchart.R`: create flowchart using DiagrammeR
`run_Bullseye_analysis.R`: run Bullseye analysis separately
`bibliography.bib`: zotero bibliography
`N_excludedSubjects.csv`: number of excluded subjects, generated by `prep_data.r`

#### Revisions
revised version of docx manuscript

### helper
helper functions to estimate model comparison in imputed datasets, perform diagnostics of mixed models and stability tests, respectively.
- `wald_confint_rlmm.R`: 
- `diagnostics_fcns.r`
- `glmm_stability.r`
    
### prepare_data
prepare original and synthetic data
- `prepare_data.R`: script will generate imputed dataset from LIFE-Adult input. This file includes inclusion/exclusion criteria as well as the imputation described in the manuscript. 
- `prepare_data_for_SBP.R`: script will generate imputed dataset from LIFE-Adult input with SBP instead of DBP
- `create_synthetic_data.R`: script will generate imputed synthetic dataset based on original data


## power_simulation
- scripts and simulated data used for power analysis for RR stage 1 protocol, see README in this folder

## MRI data preparation
- Lesion Segmentation Toolbox was run on  used all baseline scans scans (see [this repository](https://github.com/fBeyer89/life_followup_preproc/tree/master/lesion_segmentation))

